@using NestedLists.ViewModels
@model NestedLists.ViewModels.IndexViewModel
@{
    ViewBag.Title = "Home Page";
}

@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()
    @Html.ValidationSummary(true, "", new {@class = "text-danger"})

    {
        var containerTypes = Model.Containers.GroupBy(x => x.ContainerType).Distinct().ToList();
        int c = 0;

        foreach (var item in containerTypes)
        {
            c++;
            List<ContainerViewModel> containers = Model.Containers.Where(x => x.ContainerType == item.Key && x.Groups.Any()).ToList();

            <div class="row">
                <h3>@Html.LabelForModel(item.Key.ToString())</h3>
                <hr/>

                @for (var i = 0; i < containers.Count; i++)
                {
                    <div>
                        @Html.LabelForModel(containers[i].Name + " - Head - " + i)
                        @for (int j = 0; j < containers[i].Groups.Where(x => x.GroupType == item.Key).ToList().Count; j++)
                        {
                            <div>
                                @Html.CheckBoxFor(m =>containers[i].Groups[j].Selected)
                                @Html.LabelForModel(containers[i].Groups[j].GroupName + " - " + containers[i].Groups[j].GroupType.ToString())
                                @Html.HiddenFor(m => containers[i].Groups[j].Id)
                            </div>
                        }
                        @*@Html.EditorFor(m => m.Containers[i])*@
                    </div>
                }

            </div>
        }
        <div class="row">
            <div class="form-group">
                <div class="col-md-offset-2 col-md-10">
                    <input type="submit" value="Create" class="btn btn-default"/>
                </div>
            </div>
        </div>
    }
}
